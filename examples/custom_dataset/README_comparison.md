# å·¥å…·è°ƒç”¨ vs çº¯æ¨ç†å¯¹æ¯”å®éªŒ

è¿™ä¸ªç›®å½•åŒ…å«äº†å®Œæ•´çš„å¯¹æ¯”å®éªŒè®¾ç½®ï¼Œç”¨äºè¯„ä¼°å·¥å…·è°ƒç”¨å’Œçº¯æ¨ç†åœ¨True/Falseåˆ¤æ–­ä»»åŠ¡ä¸Šçš„æ•ˆæœå·®å¼‚ã€‚

## ğŸ¯ å®éªŒç›®æ ‡

é€šè¿‡åœ¨ç›¸åŒæ•°æ®é›†ä¸Šè®­ç»ƒä¸¤ä¸ªç‰ˆæœ¬çš„æ¨¡å‹æ¥å›ç­”ï¼š
- å·¥å…·è°ƒç”¨æ˜¯å¦çœŸçš„æå‡äº†æ¨ç†èƒ½åŠ›ï¼Ÿ
- åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å·¥å…·è°ƒç”¨æœ€æœ‰æ•ˆï¼Ÿ
- çº¯è¯­è¨€æ¨ç†çš„æé™åœ¨å“ªé‡Œï¼Ÿ

## ğŸ“ æ–‡ä»¶å¯¹æ¯”

### ğŸ”§ å·¥å…·è°ƒç”¨ç‰ˆæœ¬
```
generate_with_tools.py       # æ”¯æŒå¤šè½®å·¥å…·è°ƒç”¨çš„ç”Ÿæˆå‡½æ•°
train_from_pretrained.sh     # å·¥å…·è°ƒç”¨è®­ç»ƒè„šæœ¬
tool_sandbox.py             # å®‰å…¨ä»£ç æ‰§è¡Œç¯å¢ƒ
```

### ğŸ§  çº¯æ¨ç†ç‰ˆæœ¬
```
generate_without_tools.py    # çº¯è¯­è¨€æ¨ç†ç”Ÿæˆå‡½æ•°
train_without_tools.sh      # çº¯æ¨ç†è®­ç»ƒè„šæœ¬
```

### ğŸ“Š å¯¹æ¯”åˆ†æ
```
comparison_analysis.py       # è‡ªåŠ¨åŒ–å¯¹æ¯”åˆ†æè„šæœ¬
README_comparison.md        # æœ¬æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: å‡†å¤‡æ•°æ®
```bash
# è¿è¡Œæ•°æ®é¢„å¤„ç†ï¼ˆä¸¤ä¸ªç‰ˆæœ¬ä½¿ç”¨ç›¸åŒæ•°æ®ï¼‰
python data_preprocessing.py
```

### æ­¥éª¤2: å¹¶è¡Œè®­ç»ƒä¸¤ä¸ªç‰ˆæœ¬
```bash
# ç»ˆç«¯1: è®­ç»ƒå·¥å…·è°ƒç”¨ç‰ˆæœ¬
chmod +x train_from_pretrained.sh
./train_from_pretrained.sh

# ç»ˆç«¯2: è®­ç»ƒçº¯æ¨ç†ç‰ˆæœ¬
chmod +x train_without_tools.sh
./train_without_tools.sh
```

### æ­¥éª¤3: å¯¹æ¯”åˆ†æ
```bash
# ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Šå’Œå›¾è¡¨
python comparison_analysis.py --project "qwen3-reasoning-comparison"
```

## ğŸ¯ æ ¸å¿ƒå·®å¼‚å¯¹æ¯”

### ğŸ”§ å·¥å…·è°ƒç”¨ç‰ˆæœ¬ç‰¹ç‚¹

#### ç”Ÿæˆæµç¨‹
```python
# å¤šè½®å·¥å…·è°ƒç”¨æµç¨‹
for turn in range(max_turns):
    model_response = generate()  # æ¨¡å‹ç”Ÿæˆå›åº”

    if contains_tool_call(model_response):
        code = extract_code(model_response)
        result = execute_code_safely(code)  # åœ¨æ²™ç®±ä¸­æ‰§è¡Œ
        context += f"<interpreter>{result}</interpreter>"

    if contains_final_answer(model_response):
        break
```

#### å¥–åŠ±æœºåˆ¶
```python
# å·¥å…·ä½¿ç”¨å¥–åŠ±
if tool_call_count > 0 and accuracy == 1.0:
    tool_reward = +0.3  # é¼“åŠ±æ­£ç¡®ä½¿ç”¨å·¥å…·
elif tool_call_count > 0 and accuracy == 0.0:
    tool_reward = +0.1  # é¼“åŠ±å°è¯•ä½¿ç”¨å·¥å…·
else:
    tool_reward = -0.1  # è½»å¾®æƒ©ç½šä¸ä½¿ç”¨å·¥å…·
```

#### ç¤ºä¾‹å¯¹è¯
```
ç”¨æˆ·: åˆ¤æ–­ï¼šæ‰€æœ‰è´¨æ•°éƒ½æ˜¯å¥‡æ•°

æ¨¡å‹: è®©æˆ‘ç”¨ä»£ç éªŒè¯è¿™ä¸ªå‘½é¢˜ã€‚

<tool_call>
{"name": "code_interpreter", "arguments": {"code": "# æ£€æŸ¥å‰10ä¸ªè´¨æ•°\nprimes = []\nfor n in range(2, 30):\n    if all(n % i != 0 for i in range(2, int(n**0.5) + 1)):\n        primes.append(n)\n        if len(primes) >= 10: break\n\nprint('å‰10ä¸ªè´¨æ•°:', primes)\nprint('2æ˜¯è´¨æ•°ä¸”æ˜¯å¶æ•°:', 2 in primes and 2 % 2 == 0)"}}
</tool_call>

<interpreter>
å‰10ä¸ªè´¨æ•°: [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]
2æ˜¯è´¨æ•°ä¸”æ˜¯å¶æ•°: True
</interpreter>

é€šè¿‡ä»£ç éªŒè¯ï¼Œ2æ—¢æ˜¯è´¨æ•°åˆæ˜¯å¶æ•°ï¼Œæ‰€ä»¥"æ‰€æœ‰è´¨æ•°éƒ½æ˜¯å¥‡æ•°"æ˜¯é”™è¯¯çš„ã€‚

\\boxed{false}
```

### ğŸ§  çº¯æ¨ç†ç‰ˆæœ¬ç‰¹ç‚¹

#### ç”Ÿæˆæµç¨‹
```python
# å•è½®æ·±åº¦æ¨ç†
system_prompt = (
    "è¯·è¿ç”¨é€»è¾‘æ¨ç†èƒ½åŠ›ï¼Œç»™å‡ºè¯¦ç»†åˆ†æè¿‡ç¨‹ï¼Œ"
    "ä¸è¦ä¾èµ–å¤–éƒ¨å·¥å…·ï¼ŒåŸºäºçŸ¥è¯†å’Œæ¨ç†è§£å†³é—®é¢˜"
)
response = generate_once(prompt)  # ä¸€æ¬¡ç”Ÿæˆå®Œæ•´æ¨ç†
```

#### å¥–åŠ±æœºåˆ¶
```python
# æ¨ç†è´¨é‡å¥–åŠ±
reasoning_bonus = count_reasoning_indicators() * 0.05  # æ¨ç†è¯æ±‡å¥–åŠ±
logic_bonus = detect_logic_patterns() * 0.05          # é€»è¾‘ç»“æ„å¥–åŠ±
knowledge_bonus = detect_domain_knowledge() * 0.1     # çŸ¥è¯†è¿ç”¨å¥–åŠ±
```

#### ç¤ºä¾‹å¯¹è¯
```
ç”¨æˆ·: åˆ¤æ–­ï¼šæ‰€æœ‰è´¨æ•°éƒ½æ˜¯å¥‡æ•°

æ¨¡å‹: è®©æˆ‘åˆ†æè¿™ä¸ªæ•°å­¦å‘½é¢˜ã€‚

é¦–å…ˆï¼Œå›é¡¾è´¨æ•°çš„å®šä¹‰ï¼šè´¨æ•°æ˜¯å¤§äº1çš„è‡ªç„¶æ•°ï¼Œåªèƒ½è¢«1å’Œå®ƒæœ¬èº«æ•´é™¤ã€‚

å…¶æ¬¡ï¼Œè€ƒè™‘å¥‡å¶æ€§ï¼šå¥‡æ•°ä¸èƒ½è¢«2æ•´é™¤ï¼Œå¶æ•°èƒ½è¢«2æ•´é™¤ã€‚

ç°åœ¨è¿›è¡Œæ¨ç†ï¼šå¦‚æœ"æ‰€æœ‰è´¨æ•°éƒ½æ˜¯å¥‡æ•°"æˆç«‹ï¼Œé‚£ä¹ˆä¸åº”è¯¥å­˜åœ¨å¶æ•°è´¨æ•°ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“2æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•°ï¼š
- 2åªèƒ½è¢«1å’Œ2æ•´é™¤ï¼Œç¬¦åˆè´¨æ•°å®šä¹‰
- 2èƒ½è¢«2æ•´é™¤ï¼Œæ˜¯å¶æ•°

å› æ­¤ï¼Œ2æ—¢æ˜¯è´¨æ•°åˆæ˜¯å¶æ•°ï¼Œè¿™æ„æˆäº†åä¾‹ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œå­˜åœ¨å¶æ•°è´¨æ•°ï¼ˆ2ï¼‰ï¼Œæ‰€ä»¥åŸå‘½é¢˜ä¸æˆç«‹ã€‚

\\boxed{false}
```

## ğŸ“Š é¢„æœŸå¯¹æ¯”ç»“æœ

### ğŸ¯ å‡†ç¡®ç‡å¯¹æ¯”
```
å·¥å…·è°ƒç”¨ç‰ˆæœ¬: 85-90% (é€šè¿‡éªŒè¯å‡å°‘é”™è¯¯)
çº¯æ¨ç†ç‰ˆæœ¬: 75-85% (ä¾èµ–æ¨¡å‹çŸ¥è¯†å‡†ç¡®æ€§)
```

### âš¡ æ”¶æ•›é€Ÿåº¦
```
å·¥å…·è°ƒç”¨ç‰ˆæœ¬: æ›´å¿«æ”¶æ•› (æ˜ç¡®çš„å¯¹é”™åé¦ˆ)
çº¯æ¨ç†ç‰ˆæœ¬: è¾ƒæ…¢æ”¶æ•› (éœ€è¦æ›´å¤šæ ·æœ¬å­¦ä¹ )
```

### ğŸ§  æ¨ç†è´¨é‡
```
å·¥å…·è°ƒç”¨ç‰ˆæœ¬: é‡éªŒè¯ï¼Œè½»æ¨ç†è¿‡ç¨‹
çº¯æ¨ç†ç‰ˆæœ¬: é‡æ¨ç†è¿‡ç¨‹ï¼Œè½»éªŒè¯
```

### ğŸ² é€‚ç”¨èŒƒå›´
```
å·¥å…·è°ƒç”¨ç‰ˆæœ¬: é€‚åˆå®¢è§‚ã€å¯éªŒè¯é—®é¢˜
çº¯æ¨ç†ç‰ˆæœ¬: é€‚åˆä¸»è§‚ã€éœ€è¦æ·±åº¦æ€è€ƒé—®é¢˜
```

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡

### å…±åŒæŒ‡æ ‡
- `accuracy`: ç­”æ¡ˆå‡†ç¡®ç‡
- `mean_reward`: å¹³å‡å¥–åŠ±
- `format_compliance`: æ ¼å¼éµå¾ªç‡
- `reasoning_rate`: æ¨ç†è¿‡ç¨‹è´¨é‡

### å·¥å…·è°ƒç”¨ä¸“å±æŒ‡æ ‡
- `tool_usage_rate`: å·¥å…·ä½¿ç”¨é¢‘ç‡
- `avg_tool_calls`: å¹³å‡å·¥å…·è°ƒç”¨æ¬¡æ•°
- `tool_success_rate`: å·¥å…·æ‰§è¡ŒæˆåŠŸç‡

### çº¯æ¨ç†ä¸“å±æŒ‡æ ‡
- `logic_structure_rate`: é€»è¾‘ç»“æ„æ¸…æ™°åº¦
- `knowledge_usage_rate`: é¢†åŸŸçŸ¥è¯†è¿ç”¨ç‡
- `reasoning_depth_score`: æ¨ç†æ·±åº¦è¯„åˆ†

## ğŸ”§ é…ç½®è°ƒä¼˜

### å·¥å…·è°ƒç”¨ç‰ˆæœ¬ä¼˜åŒ–
```bash
# æé«˜å·¥å…·ä½¿ç”¨å¥–åŠ±
--kl-loss-coef 0.01          # è¾ƒä½KLçº¦æŸï¼Œå…è®¸æ›´å¤šæ¢ç´¢
--rollout-temperature 0.8    # é€‚ä¸­æ¸©åº¦ï¼Œå¹³è¡¡æ¢ç´¢å’Œåˆ©ç”¨
--max-tool-calls 8           # å……è¶³çš„å·¥å…·è°ƒç”¨æ¬¡æ•°
```

### çº¯æ¨ç†ç‰ˆæœ¬ä¼˜åŒ–
```bash
# é¼“åŠ±æ·±åº¦æ¨ç†
--kl-loss-coef 0.02          # ç¨é«˜KLçº¦æŸï¼Œä¿æŒæ¨ç†ç¨³å®šæ€§
--rollout-temperature 0.85   # ç¨é«˜æ¸©åº¦ï¼Œé¼“åŠ±å¤šæ ·åŒ–æ¨ç†
--max-response-length 1536   # å…è®¸æ›´é•¿çš„æ¨ç†è¿‡ç¨‹
```

## ğŸ¯ åˆ†æç»´åº¦

### å®šé‡åˆ†æ
- **å‡†ç¡®ç‡è¶‹åŠ¿**: è®­ç»ƒè¿‡ç¨‹ä¸­å‡†ç¡®ç‡å˜åŒ–
- **æ”¶æ•›é€Ÿåº¦**: è¾¾åˆ°ç›®æ ‡æ€§èƒ½æ‰€éœ€æ­¥æ•°
- **ç¨³å®šæ€§**: æ€§èƒ½æ–¹å·®å’Œæ³¢åŠ¨æƒ…å†µ
- **èµ„æºæ•ˆç‡**: GPUåˆ©ç”¨ç‡å’Œè®­ç»ƒæ—¶é—´

### å®šæ€§åˆ†æ
- **æ¨ç†è¿‡ç¨‹**: ç”Ÿæˆæ–‡æœ¬çš„é€»è¾‘æ¸…æ™°åº¦
- **é”™è¯¯æ¨¡å¼**: ä¸åŒæ–¹æ³•çš„å…¸å‹é”™è¯¯ç±»å‹
- **é€‚ç”¨åœºæ™¯**: å„è‡ªåœ¨ä¸åŒé—®é¢˜ç±»å‹ä¸Šçš„è¡¨ç°
- **æ³›åŒ–èƒ½åŠ›**: åœ¨æœªè§è¿‡é—®é¢˜ä¸Šçš„è¡¨ç°

## ğŸš€ æ‰©å±•å®éªŒ

### æ··åˆæ¨¡å¼å®éªŒ
```python
# å¯ä»¥å°è¯•çš„æ··åˆç­–ç•¥
if problem_complexity > threshold:
    use_tool_calling = True
else:
    use_pure_reasoning = True
```

### éš¾åº¦æ¢¯åº¦å®éªŒ
```python
# ä¸åŒéš¾åº¦é—®é¢˜çš„å¯¹æ¯”
easy_problems = ["åŸºç¡€æ•°å­¦äº‹å®"]
medium_problems = ["éœ€è¦è®¡ç®—éªŒè¯çš„é—®é¢˜"]
hard_problems = ["å¤æ‚é€»è¾‘æ¨ç†é—®é¢˜"]
```

### é¢†åŸŸå¯¹æ¯”å®éªŒ
```python
domains = [
    "æ•°å­¦è®¡ç®—",      # å·¥å…·è°ƒç”¨ä¼˜åŠ¿æ˜æ˜¾
    "é€»è¾‘æ¨ç†",      # å¯èƒ½æ——é¼“ç›¸å½“
    "å¸¸è¯†åˆ¤æ–­",      # çº¯æ¨ç†å¯èƒ½æ›´å¥½
    "ç§‘å­¦éªŒè¯"       # å·¥å…·è°ƒç”¨ä¼˜åŠ¿æ˜æ˜¾
]
```

## ğŸ“‹ ä½¿ç”¨æ¸…å•

- [ ] æ•°æ®é¢„å¤„ç†å®Œæˆ
- [ ] å·¥å…·è°ƒç”¨ç‰ˆæœ¬è®­ç»ƒå¯åŠ¨
- [ ] çº¯æ¨ç†ç‰ˆæœ¬è®­ç»ƒå¯åŠ¨
- [ ] Wandbç›‘æ§é…ç½®æ­£ç¡®
- [ ] å®šæœŸæ£€æŸ¥è®­ç»ƒè¿›åº¦
- [ ] è®­ç»ƒå®Œæˆåè¿è¡Œå¯¹æ¯”åˆ†æ
- [ ] åˆ†æç»“æœå¹¶å¾—å‡ºç»“è®º

è¿™ä¸ªå®Œæ•´çš„å¯¹æ¯”å®éªŒå°†å¸®åŠ©ä½ æ·±å…¥ç†è§£å·¥å…·è°ƒç”¨åœ¨æ¨ç†ä»»åŠ¡ä¸­çš„çœŸå®ä»·å€¼ï¼ğŸš€